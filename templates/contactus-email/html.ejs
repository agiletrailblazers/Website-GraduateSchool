var nodemailer = require('nodemailer');
var smtpTransport = require('nodemailer-smtp-transport');
var smtpTransport = require('nodemailer-smtp-transport');
var EmailTemplate = require('email-templates').EmailTemplate
var path = require('path')
var templatesDir = path.resolve(__dirname, '..', 'templates')
var template = new EmailTemplate(path.join(templatesDir, 'welcome-email'))
var async = require('async')
// Prepare nodemailer transport object
var transport = nodemailer.createTransport({
    service: 'yahoo',
    auth: {
        user: 'rahul7155@yahoo.com',
        pass: 'luhar12389'
    }
})

// An example users object with formatted email function
var locals = {
    email: 'rahul7155@yahoo.com',
    name: {
        first: 'Mamma',
        last: 'Mia'
    }
}

// Send a single email
template.render(locals, function (err, results) {
    if (err) {
        return console.error(err)
    }

    transport.sendMail({
        from: 'rahul7155@yahoo.com',
        to: 'rahul7155@yahoo.com',
        subject: 'Mangia gli spaghetti con polpette!',
        html: results.html,
        text: results.text
    }, function (err, responseStatus) {
        if (err) {
            return console.error(err)
        }
        console.log(responseStatus.message)
    })
})

